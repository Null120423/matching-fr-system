syntax = "proto3";

package auth;

// AuthService provides authentication-related operations
service AuthService {
  rpc SignIn (LoginRequest) returns (LoginReply);
  rpc SignUp (SignUpRequest) returns (SignUpReply);
  rpc RefreshToken (RefreshTokenRequest) returns (RefreshTokenReply);
}

// Request for refreshing the token
message RefreshTokenRequest {
  string refreshToken = 1;
}

// Reply for refreshing the token
message RefreshTokenReply {
  string refreshToken = 1;
  string accessToken = 2;
}

// Request for user login
message LoginRequest {
  string username = 1;
  string password = 2;
}

// Reply for user login
message LoginReply {
  string accessToken = 1; // JWT or session token
  string refreshToken = 2; // Corrected: should be 2 instead of 1 for uniqueness
  string message = 3;
  User user = 4;
}

// Request for user signup
message SignUpRequest {
  string username = 1;
  string password = 2;
  string confirmPassword = 3;  // Fixed colon to equal sign
  string email = 4;
}

// Reply for user signup
message SignUpReply {
  string message = 1;
}

// User information message
message User {
  string id = 1;
  string username = 2;
  repeated string favoriteActivities = 3;
  repeated string availableTimeSlots = 4;
  string location = 5;
}
